{"message": "starting worker", "level": "INFO", "name": "livekit.agents", "version": "1.1.6", "rtc-version": "1.0.11", "timestamp": "2025-07-16T07:23:53.943751+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 39240, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 25896, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 11132, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 32908, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 40312, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 38112, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 29828, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 40468, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 22760, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 36400, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 18164, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 20444, "timestamp": "2025-07-16T07:23:53.960438+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 39240, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 25896, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 40312, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 11132, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 32908, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 38112, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 29828, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 40468, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 22760, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 18164, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 20444, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.976585+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 36400, "elapsed_time": 0.02, "timestamp": "2025-07-16T07:23:53.985840+00:00"}
{"message": "see tracing information at http://localhost:55736/debug", "level": "INFO", "name": "livekit.agents", "timestamp": "2025-07-16T07:23:53.985840+00:00"}
{"message": "registered worker", "level": "INFO", "name": "livekit.agents", "id": "AW_gLaKT6aBnLCq", "url": "wss://pamtestdrive-euxn3osq.livekit.cloud", "region": "Germany", "protocol": 16, "timestamp": "2025-07-16T07:23:54.327125+00:00"}
{"message": "received job request", "level": "INFO", "name": "livekit.agents", "job_id": "AJ_eSTvJSoSyDde", "dispatch_id": "", "room_name": "agent-call-133", "agent_name": "outbound-caller", "resuming": false, "timestamp": "2025-07-16T07:23:55.724606+00:00"}
{"message": "Entrée dans la fonction entrypoint pour le job AJ_eSTvJSoSyDde", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:55.768241+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 10872, "timestamp": "2025-07-16T07:23:55.883406+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 10872, "elapsed_time": 0.0, "timestamp": "2025-07-16T07:23:55.883406+00:00"}
{"message": "Connexion établie à la room agent-call-133", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.129230+00:00"}
{"message": "Métadonnées brutes du job: {\"firstName\": \"Valued Customer\", \"lastName\": \"\", \"dial_info\": {\"agent_id\": 11, \"call_direction\": \"outbound\", \"room_name\": \"agent-call-133\", \"supabase_call_id\": 133, \"telnyx_call_control_id\": null, \"default_pathway_id\": \"d5fc510b-7635-4715-9066-e522daa2336d\", \"user_id\": \"b55837c4-270f-4f1f-8023-7ab09ee5f44d\", \"phone_number\": \"+33661329235\", \"sip_trunk_id\": \"ST_pYivozcRKCMc\"}, \"system_prompt\": \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", \"initial_greeting\": \"Hi this is Pam, how can I help ?\", \"wait_for_greeting\": false, \"pam_tier\": \"core\", \"interruption_threshold\": 100, \"ai_models\": {\"vad\": {\"provider\": \"silero\"}, \"stt\": {\"provider\": \"deepgram\", \"language\": \"en\", \"model\": \"nova-2\"}, \"tts\": {\"provider\": \"cartesia\", \"model\": \"sonic-2\", \"voice_id\": \"f9836c6e-a0bd-460e-9d3c-f7299fa60f94\"}, \"llm\": {\"provider\": \"openai\", \"model\": \"gpt-4o-mini\"}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "Métadonnées parsées: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-133', 'supabase_call_id': 133, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "supabase_call_id extrait des métadonnées: 133", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "Métadonnées du job: {\"firstName\": \"Valued Customer\", \"lastName\": \"\", \"dial_info\": {\"agent_id\": 11, \"call_direction\": \"outbound\", \"room_name\": \"agent-call-133\", \"supabase_call_id\": 133, \"telnyx_call_control_id\": null, \"default_pathway_id\": \"d5fc510b-7635-4715-9066-e522daa2336d\", \"user_id\": \"b55837c4-270f-4f1f-8023-7ab09ee5f44d\", \"phone_number\": \"+33661329235\", \"sip_trunk_id\": \"ST_pYivozcRKCMc\"}, \"system_prompt\": \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", \"initial_greeting\": \"Hi this is Pam, how can I help ?\", \"wait_for_greeting\": false, \"pam_tier\": \"core\", \"interruption_threshold\": 100, \"ai_models\": {\"vad\": {\"provider\": \"silero\"}, \"stt\": {\"provider\": \"deepgram\", \"language\": \"en\", \"model\": \"nova-2\"}, \"tts\": {\"provider\": \"cartesia\", \"model\": \"sonic-2\", \"voice_id\": \"f9836c6e-a0bd-460e-9d3c-f7299fa60f94\"}, \"llm\": {\"provider\": \"openai\", \"model\": \"gpt-4o-mini\"}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "dial_info parsed from metadata: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-133', 'supabase_call_id': 133, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "Using firstName from metadata or default: Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.130384+00:00"}
{"message": "OUTBOUND CALL: To +33661329235", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "PAM Tier: core, Wait for Greeting: False, Interruption Threshold: 100ms", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "agent_caller_id_number NOT found in job metadata. Outbound call may fail if Caller ID is required by Telnyx.", "level": "WARNING", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Utilisation du SIP Trunk ID des métadonnées: ST_pYivozcRKCMc", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Utilisation du prompt système formaté depuis les métadonnées.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Final dial info for agent: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-133', 'supabase_call_id': 133, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Agent will use name: Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Dialing number: +33661329235", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.131440+00:00"}
{"message": "Configuration IA chargée depuis les métadonnées: {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.132432+00:00"}
{"message": "Plugin VAD Silero chargé.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.244261+00:00"}
{"message": "Plugin STT Deepgram chargé (lang: en, model: nova-2).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.244261+00:00"}
{"message": "Plugin TTS Cartesia chargé (model: sonic-2, voice: f9836c6e-a0bd-460e-9d3c-f7299fa60f94).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.244261+00:00"}
{"message": "Plugin LLM OpenAI chargé (model: gpt-4o-mini).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.553764+00:00"}
{"message": "Creating standard OutboundCaller (no pathway configured)", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "--- Agent System Prompt ---", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "You're an AI sales assistant called Jen. Your Goal is to sell me paper.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "--- End Agent System Prompt ---", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "Agent initialized for OUTBOUND call to None", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "OutboundCaller (Pam Assistant) initialized for Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "dial_info provided: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-133', 'supabase_call_id': 133, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "Initial greeting set to: Hi this is Pam, how can I help ?", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "Wait for greeting: False", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.554669+00:00"}
{"message": "Interruption threshold: 100ms", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.555761+00:00"}
{"message": "Instantiating AgentSession with dynamically loaded plugins.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.555761+00:00"}
{"message": "AgentSession created successfully with dynamic plugins.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.555761+00:00"}
{"message": "OUTBOUND CALL: Attempting SIP dial to +33661329235 via trunk ST_pYivozcRKCMc pour Supabase ID: 133", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.555761+00:00"}
{"message": "Préparation de l'en-tête SIP X-Client-State avec valeur (encodée): MTMz", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.555761+00:00"}
{"message": "Tentative de mise à jour des infos pour room agent-call-133 (Supabase ID: 133) avec payload: {'new_status': 'dialing', 'supabase_call_id': '133'} via backend: http://localhost:8000/calls/room/agent-call-133/status", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:56.556482+00:00"}
{"message": "Infos mises à jour avec succès pour room agent-call-133 (Supabase ID: 133): {'message': 'Call status updated successfully', 'call': {'id': 133, 'created_at': '2025-07-16T07:23:54.047358+00:00', 'updated_at': '2025-07-16T07:23:59.904046+00:00', 'agent_id': 11, 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'to_phone_number': '+33661329235', 'status': 'dialing', 'initiated_at': None, 'answered_at': None, 'ended_at': None, 'call_duration': None, 'from_phone_number': None, 'ended_reason': None, 'livekit_room_name': None, 'livekit_participant_identity': None, 'provider': None, 'livekit_outbound_trunk_id': None, 'call_control_id': None, 'agent_name': None, 'telnyx_call_session_id': None, 'batch_campaign_id': None, 'batch_call_item_id': None, 'call_type': 'outbound', 'phone_number_e164': '+33661329235', 'contact_name': None, 'room_name': 'agent-call-133', 'pathway_execution_id': None, 'current_pathway_node_id': None, 'pathway_variables': None, 'call_direction': 'outbound', 'caller_number': None, 'agent_process_pid': 37484, 'error_message': None}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.209745+00:00"}
{"message": "Appel à ctx.api.sip.create_sip_participant avec phoneNumber: +33661329235, trunk: ST_pYivozcRKCMc, from: None, metadata: {\"supabase_call_id\": \"133\"}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.209745+00:00"}
{"message": "Unexpected error during SIP call or participant wait: SipService.create_sip_participant() got an unexpected keyword argument 'sip_trunk_id'", "level": "ERROR", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.209745+00:00"}
{"message": "Traceback (most recent call last):\n  File \"C:\\Users\\y.djemai\\pam-testdrive\\MARK_I\\backend_python\\agents\\outbound_agent.py\", line 910, in entrypoint\n    _ = await ctx.api.sip.create_sip_participant(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: SipService.create_sip_participant() got an unexpected keyword argument 'sip_trunk_id'\n", "level": "ERROR", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.210752+00:00"}
{"message": "Tentative de mise à jour des infos pour room agent-call-133 (Supabase ID: 133) avec payload: {'new_status': 'failed_sip_unexpected', 'supabase_call_id': '133'} via backend: http://localhost:8000/calls/room/agent-call-133/status", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.210752+00:00"}
{"message": "Infos mises à jour avec succès pour room agent-call-133 (Supabase ID: 133): {'message': 'Call status updated successfully', 'call': {'id': 133, 'created_at': '2025-07-16T07:23:54.047358+00:00', 'updated_at': '2025-07-16T07:24:00.459045+00:00', 'agent_id': 11, 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'to_phone_number': '+33661329235', 'status': 'failed_sip_unexpected', 'initiated_at': None, 'answered_at': None, 'ended_at': None, 'call_duration': None, 'from_phone_number': None, 'ended_reason': None, 'livekit_room_name': None, 'livekit_participant_identity': None, 'provider': None, 'livekit_outbound_trunk_id': None, 'call_control_id': None, 'agent_name': None, 'telnyx_call_session_id': None, 'batch_campaign_id': None, 'batch_call_item_id': None, 'call_type': 'outbound', 'phone_number_e164': '+33661329235', 'contact_name': None, 'room_name': 'agent-call-133', 'pathway_execution_id': None, 'current_pathway_node_id': None, 'pathway_variables': None, 'call_direction': 'outbound', 'caller_number': None, 'agent_process_pid': 37484, 'error_message': None}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:23:57.766224+00:00"}
{"message": "received job request", "level": "INFO", "name": "livekit.agents", "job_id": "AJ_fGA5dCgoe759", "dispatch_id": "", "room_name": "agent-call-134", "agent_name": "outbound-caller", "resuming": false, "timestamp": "2025-07-16T07:24:24.354444+00:00"}
{"message": "Entrée dans la fonction entrypoint pour le job AJ_fGA5dCgoe759", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.403050+00:00"}
{"message": "initializing job runner", "level": "INFO", "name": "livekit.agents", "tid": 17680, "timestamp": "2025-07-16T07:24:24.507609+00:00"}
{"message": "job runner initialized", "level": "INFO", "name": "livekit.agents", "tid": 17680, "elapsed_time": 0.0, "timestamp": "2025-07-16T07:24:24.507609+00:00"}
{"message": "Connexion établie à la room agent-call-134", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.759924+00:00"}
{"message": "Métadonnées brutes du job: {\"firstName\": \"Valued Customer\", \"lastName\": \"\", \"dial_info\": {\"agent_id\": 11, \"call_direction\": \"outbound\", \"room_name\": \"agent-call-134\", \"supabase_call_id\": 134, \"telnyx_call_control_id\": null, \"default_pathway_id\": \"d5fc510b-7635-4715-9066-e522daa2336d\", \"user_id\": \"b55837c4-270f-4f1f-8023-7ab09ee5f44d\", \"phone_number\": \"+33661329235\", \"sip_trunk_id\": \"ST_pYivozcRKCMc\"}, \"system_prompt\": \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", \"initial_greeting\": \"Hi this is Pam, how can I help ?\", \"wait_for_greeting\": false, \"pam_tier\": \"core\", \"interruption_threshold\": 100, \"ai_models\": {\"vad\": {\"provider\": \"silero\"}, \"stt\": {\"provider\": \"deepgram\", \"language\": \"en\", \"model\": \"nova-2\"}, \"tts\": {\"provider\": \"cartesia\", \"model\": \"sonic-2\", \"voice_id\": \"f9836c6e-a0bd-460e-9d3c-f7299fa60f94\"}, \"llm\": {\"provider\": \"openai\", \"model\": \"gpt-4o-mini\"}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.759924+00:00"}
{"message": "Métadonnées parsées: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-134', 'supabase_call_id': 134, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.759924+00:00"}
{"message": "supabase_call_id extrait des métadonnées: 134", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Métadonnées du job: {\"firstName\": \"Valued Customer\", \"lastName\": \"\", \"dial_info\": {\"agent_id\": 11, \"call_direction\": \"outbound\", \"room_name\": \"agent-call-134\", \"supabase_call_id\": 134, \"telnyx_call_control_id\": null, \"default_pathway_id\": \"d5fc510b-7635-4715-9066-e522daa2336d\", \"user_id\": \"b55837c4-270f-4f1f-8023-7ab09ee5f44d\", \"phone_number\": \"+33661329235\", \"sip_trunk_id\": \"ST_pYivozcRKCMc\"}, \"system_prompt\": \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", \"initial_greeting\": \"Hi this is Pam, how can I help ?\", \"wait_for_greeting\": false, \"pam_tier\": \"core\", \"interruption_threshold\": 100, \"ai_models\": {\"vad\": {\"provider\": \"silero\"}, \"stt\": {\"provider\": \"deepgram\", \"language\": \"en\", \"model\": \"nova-2\"}, \"tts\": {\"provider\": \"cartesia\", \"model\": \"sonic-2\", \"voice_id\": \"f9836c6e-a0bd-460e-9d3c-f7299fa60f94\"}, \"llm\": {\"provider\": \"openai\", \"model\": \"gpt-4o-mini\"}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "dial_info parsed from metadata: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-134', 'supabase_call_id': 134, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Using firstName from metadata or default: Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "OUTBOUND CALL: To +33661329235", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "PAM Tier: core, Wait for Greeting: False, Interruption Threshold: 100ms", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "agent_caller_id_number NOT found in job metadata. Outbound call may fail if Caller ID is required by Telnyx.", "level": "WARNING", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Utilisation du SIP Trunk ID des métadonnées: ST_pYivozcRKCMc", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Utilisation du prompt système formaté depuis les métadonnées.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Final dial info for agent: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-134', 'supabase_call_id': 134, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Agent will use name: Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.760880+00:00"}
{"message": "Dialing number: +33661329235", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.761992+00:00"}
{"message": "Configuration IA chargée depuis les métadonnées: {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.761992+00:00"}
{"message": "Plugin VAD Silero chargé.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.838134+00:00"}
{"message": "Plugin STT Deepgram chargé (lang: en, model: nova-2).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.838134+00:00"}
{"message": "Plugin TTS Cartesia chargé (model: sonic-2, voice: f9836c6e-a0bd-460e-9d3c-f7299fa60f94).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:24.838134+00:00"}
{"message": "Plugin LLM OpenAI chargé (model: gpt-4o-mini).", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "Creating standard OutboundCaller (no pathway configured)", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "--- Agent System Prompt ---", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "You're an AI sales assistant called Jen. Your Goal is to sell me paper.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "--- End Agent System Prompt ---", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "Agent initialized for OUTBOUND call to None", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "OutboundCaller (Pam Assistant) initialized for Valued Customer", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "dial_info provided: {'firstName': 'Valued Customer', 'lastName': '', 'dial_info': {'agent_id': 11, 'call_direction': 'outbound', 'room_name': 'agent-call-134', 'supabase_call_id': 134, 'telnyx_call_control_id': None, 'default_pathway_id': 'd5fc510b-7635-4715-9066-e522daa2336d', 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'phone_number': '+33661329235', 'sip_trunk_id': 'ST_pYivozcRKCMc'}, 'system_prompt': \"You're an AI sales assistant called Jen. Your Goal is to sell me paper.\", 'initial_greeting': 'Hi this is Pam, how can I help ?', 'wait_for_greeting': False, 'pam_tier': 'core', 'interruption_threshold': 100, 'ai_models': {'vad': {'provider': 'silero'}, 'stt': {'provider': 'deepgram', 'language': 'en', 'model': 'nova-2'}, 'tts': {'provider': 'cartesia', 'model': 'sonic-2', 'voice_id': 'f9836c6e-a0bd-460e-9d3c-f7299fa60f94'}, 'llm': {'provider': 'openai', 'model': 'gpt-4o-mini'}}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "Initial greeting set to: Hi this is Pam, how can I help ?", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "Wait for greeting: False", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.039567+00:00"}
{"message": "Interruption threshold: 100ms", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "Instantiating AgentSession with dynamically loaded plugins.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "AgentSession created successfully with dynamic plugins.", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "OUTBOUND CALL: Attempting SIP dial to +33661329235 via trunk ST_pYivozcRKCMc pour Supabase ID: 134", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "Préparation de l'en-tête SIP X-Client-State avec valeur (encodée): MTM0", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "Tentative de mise à jour des infos pour room agent-call-134 (Supabase ID: 134) avec payload: {'new_status': 'dialing', 'supabase_call_id': '134'} via backend: http://localhost:8000/calls/room/agent-call-134/status", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.040609+00:00"}
{"message": "Infos mises à jour avec succès pour room agent-call-134 (Supabase ID: 134): {'message': 'Call status updated successfully', 'call': {'id': 134, 'created_at': '2025-07-16T07:24:22.575919+00:00', 'updated_at': '2025-07-16T07:24:28.287572+00:00', 'agent_id': 11, 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'to_phone_number': '+33661329235', 'status': 'dialing', 'initiated_at': None, 'answered_at': None, 'ended_at': None, 'call_duration': None, 'from_phone_number': None, 'ended_reason': None, 'livekit_room_name': None, 'livekit_participant_identity': None, 'provider': None, 'livekit_outbound_trunk_id': None, 'call_control_id': None, 'agent_name': None, 'telnyx_call_session_id': None, 'batch_campaign_id': None, 'batch_call_item_id': None, 'call_type': 'outbound', 'phone_number_e164': '+33661329235', 'contact_name': None, 'room_name': 'agent-call-134', 'pathway_execution_id': None, 'current_pathway_node_id': None, 'pathway_variables': None, 'call_direction': 'outbound', 'caller_number': None, 'agent_process_pid': 34952, 'error_message': None}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.592728+00:00"}
{"message": "Appel à ctx.api.sip.create_sip_participant avec phoneNumber: +33661329235, trunk: ST_pYivozcRKCMc, from: None, metadata: {\"supabase_call_id\": \"134\"}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.592728+00:00"}
{"message": "Unexpected error during SIP call or participant wait: SipService.create_sip_participant() got an unexpected keyword argument 'sip_trunk_id'", "level": "ERROR", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.592728+00:00"}
{"message": "Traceback (most recent call last):\n  File \"C:\\Users\\y.djemai\\pam-testdrive\\MARK_I\\backend_python\\agents\\outbound_agent.py\", line 910, in entrypoint\n    _ = await ctx.api.sip.create_sip_participant(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: SipService.create_sip_participant() got an unexpected keyword argument 'sip_trunk_id'\n", "level": "ERROR", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.594239+00:00"}
{"message": "Tentative de mise à jour des infos pour room agent-call-134 (Supabase ID: 134) avec payload: {'new_status': 'failed_sip_unexpected', 'supabase_call_id': '134'} via backend: http://localhost:8000/calls/room/agent-call-134/status", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:25.594239+00:00"}
{"message": "Infos mises à jour avec succès pour room agent-call-134 (Supabase ID: 134): {'message': 'Call status updated successfully', 'call': {'id': 134, 'created_at': '2025-07-16T07:24:22.575919+00:00', 'updated_at': '2025-07-16T07:24:28.835127+00:00', 'agent_id': 11, 'user_id': 'b55837c4-270f-4f1f-8023-7ab09ee5f44d', 'to_phone_number': '+33661329235', 'status': 'failed_sip_unexpected', 'initiated_at': None, 'answered_at': None, 'ended_at': None, 'call_duration': None, 'from_phone_number': None, 'ended_reason': None, 'livekit_room_name': None, 'livekit_participant_identity': None, 'provider': None, 'livekit_outbound_trunk_id': None, 'call_control_id': None, 'agent_name': None, 'telnyx_call_session_id': None, 'batch_campaign_id': None, 'batch_call_item_id': None, 'call_type': 'outbound', 'phone_number_e164': '+33661329235', 'contact_name': None, 'room_name': 'agent-call-134', 'pathway_execution_id': None, 'current_pathway_node_id': None, 'pathway_variables': None, 'call_direction': 'outbound', 'caller_number': None, 'agent_process_pid': 34952, 'error_message': None}}", "level": "INFO", "name": "outbound-caller", "timestamp": "2025-07-16T07:24:26.144399+00:00"}
{"message": "draining worker", "level": "INFO", "name": "livekit.agents", "id": "AW_gLaKT6aBnLCq", "timeout": 1800, "timestamp": "2025-07-16T07:24:34.714296+00:00"}
{"message": "shutting down worker", "level": "INFO", "name": "livekit.agents", "id": "AW_gLaKT6aBnLCq", "timestamp": "2025-07-16T07:24:34.715304+00:00"}
